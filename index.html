<!DOCTYPE html>
<html>
<head>
  <title>Go for a Punch Research Timeline</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .item img {
      cursor: pointer;
      transition: transform 0.3s;
    }
    .item img:hover {
      transform: scale(1.1);
    }
    .lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 9999;
      overflow: auto;
    }
    .lightbox-image {
      max-width: 90%;
      max-height: 90%;
      margin: auto;
      display: block;
      margin-top: 5%;
    }
    .lightbox-close {
      position: absolute;
      top: 10px;
      right: 20px;
      color: #fff;
      font-size: 30px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Go for a Punch Research Timeline</h1>
  <div class="timeline">
    <div class="year-nav">
      <select id="yearSelector" onchange="filterTimeline(this.value)">
        <option value="all">All</option>
      </select>
      <button onclick="toggleSorting()">Toggle Sorting Order</button>
    </div>
    <div class="items-container"></div>
    <div class="placeholder-item">
      <p>Sorry, we don't have enough data on this year!</p>
      <p>If you believe this to be a mistake, please contact u/pikachubolk or email pikachubolk@schoolsquid.xyz.</p>
    </div>
  </div>

  <div class="lightbox">
    <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
    <img class="lightbox-image" src="" alt="Zoomed Image">
  </div>

  <script>
    const timeline = [
      { year: '2019', month: '12', day: '22', title: 'The fake OP?', description: 'On this day, the researchers from the SakiSanobashi subreddit had an encounter with a user who claimed to be the original poster (OP) from the 4chan thread. However, nobody could confirm right away whether he was the real deal or not.', image: 'https://via.placeholder.com/500x300', url: 'https://www.reddit.com/r/SakiSanobashi/comments/ee5bgd/i_am_the_op_of_saki_sanobashi_its_fake_and_im/' },
      { year: '2022', month: '03', day: '06', title: 'Pezle Released Saki video', description: 'Youtube content creator Pezle created a video about Go For A Punch', image: 'https://img.youtube.com/vi/f2DqsAN4VJ4/0.jpg', url: 'https://www.youtube.com/watch?v=f2DqsAN4VJ4' },
      { year: '2020', month: '01', day: '24', title: 'The fake OP, Debunked?', description: 'On this day researcher u/SteliosRotas debunked the post made by u/SakiSanobashiOP', image: 'https://via.placeholder.com/500x300', url: 'https://www.reddit.com/r/SakiSanobashi/comments/hf75j6/we_have_finally_debunked_usakisanobashiop/' },
      { year: '2015', month: '02', day: '21', title: 'The OP first posted about "Go For A Punch"', description: 'This is the first day the community heard about "Go For A Punch" and also the start of a long search!', image: 'https://pbs.twimg.com/media/E8My0_wXoAQa2xA?format=jpg&name=large', url: 'https://goforapunch.com/OP' }
    ];

    let sortByNewest = true;

    const yearSelector = document.getElementById('yearSelector');
    const itemsContainer = document.querySelector('.items-container');
    const placeholderItem = document.querySelector('.placeholder-item');
    const placeholderText = placeholderItem.querySelector('p:first-child');
    const placeholderContact = placeholderItem.querySelector('p:last-child');
    const lightbox = document.querySelector('.lightbox');
    const lightboxImage = document.querySelector('.lightbox-image');

    const formattedDates = [];

    const minYear = 2000;
    const maxYear = 2023;

    for (let year = minYear; year <= maxYear; year++) {
      const option = document.createElement('option');
      option.value = year.toString();
      option.textContent = year.toString();
      yearSelector.appendChild(option);
    }

    timeline.forEach(item => {
      const { year, month, day, title, description, image, url } = item;

      const itemDiv = document.createElement('div');
      itemDiv.classList.add('item');
      itemDiv.dataset.year = year;
      itemDiv.dataset.month = month;
      itemDiv.dataset.day = day;

      const img = document.createElement('img');
      img.src = image || 'https://via.placeholder.com/500x300';
      img.alt = 'Placeholder Image';
      img.addEventListener('click', () => {
        openLightbox(img.src);
      });
      itemDiv.appendChild(img);

      const contentDiv = document.createElement('div');
      contentDiv.classList.add('content');

      const titleH2 = document.createElement('h2');
      titleH2.textContent = title;
      contentDiv.appendChild(titleH2);

      const descriptionP = document.createElement('p');
      descriptionP.textContent = description;
      contentDiv.appendChild(descriptionP);

      const dateP = document.createElement('p');
      dateP.classList.add('date');
      dateP.textContent = `${day}/${month}/${year}`;
      contentDiv.appendChild(dateP);

      const button = document.createElement('button');
      button.textContent = 'View Details';
      button.disabled = !url; // Disable the button if no URL is specified
      button.dataset.url = url; // Set the URL as a data attribute
      button.addEventListener('click', () => {
        if (url) {
          window.location.href = url;
        }
      });
      contentDiv.appendChild(button);

      itemDiv.appendChild(contentDiv);

      itemsContainer.appendChild(itemDiv);

      formattedDates.push(`${month}/${day}/${year}`);
    });

    const dateElements = document.querySelectorAll('.item .date');
    dateElements.forEach((dateElement, index) => {
      dateElement.textContent = formattedDates[index];
    });

    filterTimeline('all');

    function filterTimeline(year) {
      const items = document.querySelectorAll('.item');
      yearSelector.value = year;

      items.forEach(item => {
        const itemYear = item.dataset.year;
        if (year === 'all' || itemYear === year) {
          item.style.display = 'block';
        } else {
          item.style.display = 'none';
        }
      });

      if (year === 'all') {
        placeholderItem.style.display = 'none';
      } else if (document.querySelectorAll('.item[data-year="' + year + '"]').length === 0) {
        placeholderItem.style.display = 'block';
        placeholderText.textContent = `Sorry, we don't have enough data on this year!`;
        placeholderContact.style.display = 'block';
      } else {
        placeholderItem.style.display = 'none';
        placeholderContact.style.display = 'none';
      }
    }

    function toggleSorting() {
      sortByNewest = !sortByNewest;
      const items = document.querySelectorAll('.item');
      const sortedItems = Array.from(items).sort((a, b) => {
        const dateA = new Date(a.dataset.year, a.dataset.month, a.dataset.day);
        const dateB = new Date(b.dataset.year, b.dataset.month, b.dataset.day);
        return sortByNewest ? dateB - dateA : dateA - dateB;
      });

      itemsContainer.innerHTML = '';
      sortedItems.forEach(item => {
        itemsContainer.appendChild(item);
      });
    }

    function openLightbox(imageSrc) {
      lightboxImage.src = imageSrc;
      lightbox.style.display = 'block';
    }

    function closeLightbox() {
      lightbox.style.display = 'none';
    }
  </script>
</body>
</html>
